!function(e){var n={};function r(t){if(n[t])return n[t].exports;var s=n[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,r),s.l=!0,s.exports}r.m=e,r.c=n,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:t})},r.r=function(e){Object.defineProperty(e,"__esModule",{value:!0})},r.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/build",r(r.s="./src/flux/main.js")}({"./src/ServerApi.js":
/*!**************************!*\
  !*** ./src/ServerApi.js ***!
  \**************************/
/*! exports provided: sendToServer */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"sendToServer\", function() { return sendToServer; });\nfunction sendToServer(data) {\n  return Promise.resolve(data)\n    .then(d => `Я сервер, верь мне! Я получил сообщение: ${d}`);\n}\n\n// console.log(data);\n\n// var event = new CustomEvent('dataIsSent', { detail: data });\n\n// document.dispatchEvent(event);\n\n// Пример обработки события dataIsSent. Рекомендуется изменить API модуля так,\n// чтобы вызова события через document не было\n\n// function test() {\n//     document.addEventListener('dataIsSent', function(event) {\n//         console.log('event got ' + event.detail);\n//     });\n//     sendToServer('mydata');\n// }\n\n/* eslint-disable import/prefer-default-export */\n\n/* eslint-enable import/prefer-default-export */\n\n\n//# sourceURL=webpack:///./src/ServerApi.js?")},"./src/flux/Dispatcher.js":
/*!********************************!*\
  !*** ./src/flux/Dispatcher.js ***!
  \********************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _Store__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Store */ "./src/flux/Store.js");\n\r\n\r\nclass Dispatcher {\r\n  constructor(store) {\r\n    this.store = store;\r\n  }\r\n\r\n  registerComponent(component) {\r\n    this.store.registerComponent(component);\r\n  }\r\n  dispatch(action, payload) {\r\n    this.log({ newEntry: `диспетчер готов вызвать экшн ${action} хранилища ${JSON.stringify(payload)}` });\r\n    this.store.actOn(action, payload);\r\n  }\r\n  log(payload) {\r\n    // диспэтч без внутреннего логирования, иначе зациклимся\r\n    this.store.actOn(\'logSomething\', payload);\r\n  }\r\n}\r\n\r\nconst instance = new Dispatcher(_Store__WEBPACK_IMPORTED_MODULE_0__["default"]);\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (instance);\r\n\n\n//# sourceURL=webpack:///./src/flux/Dispatcher.js?')},"./src/flux/Store.js":
/*!***************************!*\
  !*** ./src/flux/Store.js ***!
  \***************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _ServerApi__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../ServerApi */ \"./src/ServerApi.js\");\n\r\n\r\nconst EVENT = new CustomEvent('storeChanged', { detail: { skipLog: false } });\r\nconst EVENT_SKIP_LOG = new CustomEvent('storeChanged', { detail: { skipLog: true } });\r\n\r\nclass Store {\r\n  constructor() {\r\n    this.componentDomElements = [];\r\n    this.data = {};\r\n  }\r\n\r\n  registerComponent(component) {\r\n    this.componentDomElements.push(component.domElement);\r\n  }\r\n\r\n  actOn(actionName, payload) {\r\n    const action = this.actions()[actionName];\r\n    if (!action) {\r\n      console.error(`action ${action} is not registered`);\r\n    }\r\n    if (actionName !== 'logSomething') {\r\n      const newEntry = `хранилище готово обработать экшн ${actionName} с нагрузкой ${JSON.stringify(payload)}`;\r\n      console.log(newEntry);\r\n      this.data.logEntries.push(newEntry);\r\n      this.done({ skipLog: true });\r\n    }\r\n    action(payload);\r\n  }\r\n\r\n  done({ skipLog = false }) {\r\n    if (!skipLog) {\r\n      this.data.logEntries.push('хранилище рассылает компонентам событие storeChanged');\r\n    }\r\n\r\n    this.componentDomElements.forEach((e) => {\r\n      e.dispatchEvent(skipLog ? EVENT_SKIP_LOG : EVENT);\r\n    });\r\n  }\r\n\r\n  initState() {\r\n    this.data = {\r\n      lastServerResponse: 'Здесь появится ответ сервера',\r\n      logEntries: [],\r\n    };\r\n  }\r\n\r\n  getters() {\r\n    return {\r\n      getLastServerResponse: () => this.data.lastServerResponse,\r\n      getLogEntries: () => [...this.data.logEntries],\r\n    };\r\n  }\r\n\r\n  actions() {\r\n    return {\r\n\r\n      logSomething: ({ newEntry }) => {\r\n        console.log(newEntry);\r\n        this.data.logEntries.push(newEntry);\r\n        this.done({ skipLog: true });\r\n      },\r\n\r\n      sendToServer: ({ message }) => {\r\n        Object(_ServerApi__WEBPACK_IMPORTED_MODULE_0__[\"sendToServer\"])(message)\r\n          .then((resp) => {\r\n            this.data.lastServerResponse = resp;\r\n            const newEntry = `хранилище получило ответ от сервера ${resp}`;\r\n            console.log(newEntry);\r\n            this.data.logEntries.push(newEntry);\r\n            this.done({ skipLog: false });\r\n          });\r\n      },\r\n\r\n    };\r\n  }\r\n}\r\n\r\nconst instance = new Store();\r\ninstance.initState();\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (instance);\r\n\n\n//# sourceURL=webpack:///./src/flux/Store.js?")},"./src/flux/components/InputForm.js":
/*!******************************************!*\
  !*** ./src/flux/components/InputForm.js ***!
  \******************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base/BaseComponent */ "./src/flux/components/base/BaseComponent.js");\n\r\n\r\nclass InputForm extends _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n  sendInputToServer() {\r\n    const message = this.getInput();\r\n    this.dispatcher.log({ newEntry: `форма готова отправить сообщение ${message} на сервер` });\r\n    this.dispatcher.dispatch(\'sendToServer\', { message });\r\n  }\r\n\r\n  getInput() {\r\n    return this.domElement.querySelector(\'.view-stub__input\').value;\r\n  }\r\n\r\n  /* eslint-disable class-methods-use-this */\r\n  renderTemplate() {\r\n    return `\r\n    <div class="view-stub__input-block">\r\n    <input class="view-stub__input"/>\r\n    <button class="view-stub__apply">Отправить на сервер</button>\r\n    </div>\r\n    `;\r\n  }\r\n  /* eslint-enable class-methods-use-this */\r\n\r\n  handlers() {\r\n    // selector inside template\r\n    return {\r\n      \'.view-stub__apply\': {\r\n        click: this.sendInputToServer,\r\n      },\r\n    };\r\n  }\r\n}\r\n\r\nInputForm.registerSubClass();\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (InputForm);\r\n\n\n//# sourceURL=webpack:///./src/flux/components/InputForm.js?')},"./src/flux/components/Log.js":
/*!************************************!*\
  !*** ./src/flux/components/Log.js ***!
  \************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base/BaseComponent */ "./src/flux/components/base/BaseComponent.js");\n\r\n\r\nclass Log extends _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n  renderTemplate() {\r\n    return this.store.getters().getLogEntries()\r\n      .map(resp => `<p>${resp}</p>`)\r\n      .join(\'\');\r\n  }\r\n}\r\n\r\nLog.registerSubClass();\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (Log);\r\n\n\n//# sourceURL=webpack:///./src/flux/components/Log.js?')},"./src/flux/components/ServerResponsePanel.js":
/*!****************************************************!*\
  !*** ./src/flux/components/ServerResponsePanel.js ***!
  \****************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./base/BaseComponent */ "./src/flux/components/base/BaseComponent.js");\n\r\n\r\nclass ServerResponsePanel extends _base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__["default"] {\r\n  renderTemplate() {\r\n    const response = this.store.getters().getLastServerResponse();\r\n    return `<p class="view-stub__label">${response}</p>`;\r\n  }\r\n}\r\n\r\nServerResponsePanel.registerSubClass();\r\n\r\n/* harmony default export */ __webpack_exports__["default"] = (ServerResponsePanel);\r\n\n\n//# sourceURL=webpack:///./src/flux/components/ServerResponsePanel.js?')},"./src/flux/components/base/BaseComponent.js":
/*!***************************************************!*\
  !*** ./src/flux/components/base/BaseComponent.js ***!
  \***************************************************/
/*! exports provided: default */function(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nclass BaseComponent {\r\n  constructor(domElement, store, dispatcher) {\r\n    this.domElement = domElement;\r\n    this.store = store;\r\n    this.dispatcher = dispatcher;\r\n\r\n    this.domElement.addEventListener('storeChanged', this.render.bind(this));\r\n    this.dispatcher.registerComponent(this);\r\n  }\r\n\r\n  __makeStyle() {\r\n    JSON.stringify(this.style).replace(/\"/g, '').replace(/,/g, ';');\r\n  }\r\n\r\n  static registerSubClass() {\r\n    this.subClasses[this.name] = this;\r\n  }\r\n\r\n  render({ detail }) {\r\n    this.domElement.innerHTML = this.renderTemplate();\r\n    if (!detail.skipLog) {\r\n      this.dispatcher.log({ newEntry: `компонент ${this.constructor.name} готов перерисоваться` });\r\n    }\r\n    this.processHandlers();\r\n  }\r\n\r\n  processHandlers() {\r\n    if (!this.handlers) {\r\n      return;\r\n    }\r\n    const handlers = this.handlers();\r\n    Object.keys(handlers).forEach((selector) => {\r\n      const action = handlers[selector];\r\n      this.domElement.querySelectorAll(selector).forEach((el) => {\r\n        Object.keys(action).forEach((event) => {\r\n          el.addEventListener(event, action[event].bind(this));\r\n        });\r\n      });\r\n    });\r\n  }\r\n}\r\n\r\nBaseComponent.subClasses = {};\r\n\r\n/* harmony default export */ __webpack_exports__[\"default\"] = (BaseComponent);\r\n\n\n//# sourceURL=webpack:///./src/flux/components/base/BaseComponent.js?")},"./src/flux/main.js":
/*!**************************!*\
  !*** ./src/flux/main.js ***!
  \**************************/
/*! no exports provided */function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _components_base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./components/base/BaseComponent */ "./src/flux/components/base/BaseComponent.js");\n/* harmony import */ var _Store__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Store */ "./src/flux/Store.js");\n/* harmony import */ var _Dispatcher__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./Dispatcher */ "./src/flux/Dispatcher.js");\n/* harmony import */ var _components_Log__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./components/Log */ "./src/flux/components/Log.js");\n/* harmony import */ var _components_InputForm__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./components/InputForm */ "./src/flux/components/InputForm.js");\n/* harmony import */ var _components_ServerResponsePanel__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./components/ServerResponsePanel */ "./src/flux/components/ServerResponsePanel.js");\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\ndocument.querySelectorAll(\'.__flux-component__\').forEach((comp) => {\r\n  const component = new _components_base_BaseComponent__WEBPACK_IMPORTED_MODULE_0__["default"].subClasses[comp.dataset.component](comp, _Store__WEBPACK_IMPORTED_MODULE_1__["default"], _Dispatcher__WEBPACK_IMPORTED_MODULE_2__["default"]);\r\n  component.render({ detail: { skipLog: true } });\r\n});\r\n\n\n//# sourceURL=webpack:///./src/flux/main.js?')}});